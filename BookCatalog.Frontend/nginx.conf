server {
    listen 80;

    location / {
        root /usr/share/nginx/html;
        index index.html;
        try_files $uri /index.html; # Redirect unknown routes to index.html
    }

    # Serve .wasm files with the correct MIME type
    location ~* \.wasm$ {
        root /usr/share/nginx/html;
        add_header Content-Type application/wasm;
        add_header Cache-Control "public, max-age=31536000, immutable"; # Enable caching
    }

    # Serve static assets (CSS, JS, images) with caching
    location ~* \.(?:ico|css|js|woff|woff2|ttf|svg|eot|png|jpg|jpeg|gif|webp|avif)$ {
        root /usr/share/nginx/html;
        add_header Cache-Control "public, max-age=31536000, immutable"; # Enable long-term caching
        access_log off; # Optional: Reduce log clutter for static files
    }

    # Handle 404 errors by redirecting to index.html for SPA routing
    error_page 404 /index.html;
    location = /index.html {
        root /usr/share/nginx/html;
        add_header Cache-Control "no-cache"; # Prevent caching of index.html
    }
}
